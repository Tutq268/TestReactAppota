{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _isEqual = require('lodash/isEqual');\n\nvar _isEqual2 = _interopRequireDefault(_isEqual);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar dataKeys = {\n  'line': 'data',\n  'radar': 'data',\n  'bar': 'data',\n  'horizontalBar': 'data',\n  'bubble': 'data'\n};\n\nvar updatePoints = function updatePoints(nextProps, chart, dataKey) {\n  var name = chart.config.type;\n  var nextProps = nextProps;\n\n  if (name === 'polarArea' || name === 'pie' || name === 'doughnut') {\n    nextProps.data.datasets.forEach(function (segment, segmentIndex) {\n      if (!chart.data.datasets[segmentIndex]) {\n        chart.data.labels.push(nextProps.data.labels[segmentIndex]);\n        chart.data.datasets.forEach(function (dataset) {\n          dataset.data.push(segment);\n        });\n      } else {\n        Object.keys(segment).forEach(function (key) {\n          chart.data.datasets[segmentIndex][key] = segment[key];\n        });\n      }\n    });\n\n    while (nextProps.data.datasets.length < chart.data.datasets.length) {\n      removeData(chart);\n    }\n  } else if (name === \"radar\") {\n    removeData(chart);\n    nextProps.data.datasets.forEach(function (set, setIndex) {\n      set.data.forEach(function (val, pointIndex) {\n        if (typeof chart.data.datasets[setIndex][dataKey][pointIndex] == \"undefined\") {\n          addData(nextProps, chart, setIndex);\n        } else {\n          chart.data.datasets[setIndex][dataKey][pointIndex] = val;\n        }\n      });\n    });\n  } else if (name === \"bubble\") {\n    while (chart.data.datasets.length > nextProps.data.datasets.length) {\n      chart.data.datasets.pop();\n    }\n\n    nextProps.data.datasets.forEach(function (set, setIndex) {\n      if (typeof chart.data.datasets[setIndex] == \"undefined\") {\n        chart.data.datasets.push(nextProps.data.datasets[setIndex]);\n      } else {\n        chart.data.datasets[setIndex][dataKey] = set.data;\n      }\n    });\n  } else if (name === \"scatter\") {\n    if (chart.data.datasets.length > nextProps.data.datasets.length) {\n      chart.data.datasets.pop();\n    }\n\n    nextProps.data.datasets.forEach(function (set, setIndex) {\n      if (typeof chart.data.datasets[setIndex] == \"undefined\") {\n        chart.data.datasets.push(nextProps.data.datasets[setIndex]);\n      } else {\n        chart.data.datasets[setIndex] = nextProps.data.datasets[setIndex];\n      }\n    });\n  } else {\n    while (chart.data.labels.length > nextProps.data.labels.length) {\n      removeData(chart);\n    }\n\n    nextProps.data.datasets.forEach(function (set, setIndex) {\n      set.data.forEach(function (val, pointIndex) {\n        if (typeof chart.data.datasets[setIndex][dataKey][pointIndex] == \"undefined\") {\n          addData(nextProps, chart, setIndex);\n        } else {\n          chart.data.datasets[setIndex][dataKey][pointIndex] = val;\n        }\n      });\n    });\n  }\n};\n\nfunction addData(nextProps, chart, setIndex) {\n  chart.data.labels.push(nextProps.data.labels[setIndex]);\n  chart.data.datasets.forEach(function (dataset) {\n    dataset.data.push(nextProps.data);\n  });\n}\n\nfunction removeData(chart) {\n  chart.data.labels.pop();\n  chart.data.datasets.forEach(function (dataset) {\n    dataset.data.pop();\n  });\n}\n\nvar Chart = function (_React$Component) {\n  _inherits(Chart, _React$Component);\n\n  function Chart(props) {\n    _classCallCheck(this, Chart);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _this.state = {};\n\n    _this.handleOnClick = function (event) {\n      var _this$props = _this.props,\n          getDatasetAtEvent = _this$props.getDatasetAtEvent,\n          getElementAtEvent = _this$props.getElementAtEvent,\n          getElementsAtEvent = _this$props.getElementsAtEvent;\n      getDatasetAtEvent && getDatasetAtEvent(_this.state.chart.getDatasetAtEvent(event), event);\n      getElementAtEvent && getElementAtEvent(_this.state.chart.getElementAtEvent(event), event);\n      getElementsAtEvent && getElementsAtEvent(_this.state.chart.getElementsAtEvent(event), event);\n    };\n\n    _this.canvassRef = _react2.default.createRef();\n    return _this;\n  }\n\n  Chart.prototype.componentDidMount = function componentDidMount() {\n    this.initializeChart(this.props);\n    this.props.getChart && this.props.getChart(this.state.chart);\n    this.props.getCanvas && this.props.getCanvas(this.canvassRef);\n  };\n\n  Chart.prototype.componentWillUnmount = function componentWillUnmount() {\n    var chart = this.state.chart;\n    chart.destroy();\n  };\n\n  Chart.prototype.shouldComponentUpdate = function shouldComponentUpdate(nextProps, nextState) {\n    var _props2 = this.props,\n        redraw = _props2.redraw,\n        type = _props2.type,\n        options = _props2.options,\n        height = _props2.height,\n        width = _props2.width,\n        data = _props2.data,\n        plugins = _props2.plugins;\n\n    if (!(0, _isEqual2.default)(data.datasets, nextProps.data.datasets) || nextProps.redraw == true || type != nextProps.type || height != nextProps.height || width != nextProps.width || !(0, _isEqual2.default)(options, nextProps.options) || !(0, _isEqual2.default)(plugins, nextProps.plugins)) {\n      var chart = this.state.chart;\n\n      if (nextProps.redraw) {\n        chart.destroy();\n        this.initializeChart(nextProps);\n      } else {\n        var dataKey = nextProps.dataKey || dataKeys[chart.config.type];\n        updatePoints(nextProps, chart, dataKey);\n\n        if (chart.scales) {\n          chart.config.data.labels = nextProps.data.labels;\n        }\n\n        chart.update();\n        return false;\n      }\n    }\n  };\n\n  Chart.prototype.render = function render() {\n    var excludedProps = ['data', 'options', 'redraw'];\n    var _props = {};\n\n    for (var name in this.props) {\n      if (this.props.hasOwnProperty(name)) {\n        if (excludedProps.indexOf(name) === -1) {\n          _props[name] = this.props[name];\n        }\n      }\n    }\n\n    var canvasStyle = {\n      width: this.props.width ? this.props.width : \"auto\",\n      height: this.props.height ? this.props.height : \"auto\"\n    };\n    return _react2.default.createElement('div', null, _react2.default.createElement('canvas', {\n      ref: this.props.ref ? this.props.ref : this.canvassRef,\n      style: canvasStyle,\n      onClick: this.handleOnClick\n    }));\n  };\n\n  Chart.prototype.initializeChart = function initializeChart(nextProps) {\n    var Chart = require('chart.js');\n\n    var el = _reactDom2.default.findDOMNode(this.canvassRef.current);\n\n    var ctx = el.getContext(\"2d\");\n    var chart = new Chart(ctx, {\n      type: nextProps.type,\n      data: nextProps.data,\n      options: nextProps.options || {},\n      plugins: nextProps.plugins || {}\n    });\n    this.state.chart = chart;\n  };\n\n  return Chart;\n}(_react2.default.Component);\n\nexports.default = Chart;","map":null,"metadata":{},"sourceType":"script"}